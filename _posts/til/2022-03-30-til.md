---
title:  "220330 Today I Learned"
categories: 'til'
---
<!-- 
![aas](/assets/til/220328til1.png)

<img src="/assets/til/220328til1.png" width="100%" height="100%"> -->



### 일지

**AWS 계정해킹**

어제 TIL 작성하면서 강의중 입력했던 커맨드들도 기록했는데, 별생각없이 액세스키와 시크릿 액세스키 모두를 기록하고 커밋해서 PUSH했다.

와.. PUSH하고 5분도 지나지 않아서 Git Guardian에서 메일오고, 10분도 지나지않아서 AWS에서 키 노출되었다고 메일오고, 30분내에 계정이 자동 잠금처리되었다.

그래도 그사이에 누군가 접속해서 c5.xlarge 인스턴스를 아시아리전 전체랑 eu리전 전체에 도배하고, 미국리전에도 생성하다가 걸려서 계정정지랑 인스턴스 멈춤처리되었다.



솔직히 뭐 맨날 암호는 주기적으로 바꿔야한다, 노출에 유의해야한다는 이야기는 자주들었지만 먼세계이야기인줄 알았는데

실제로 탈취되고(라기보단 내가 노출시켰지만;) 소액이지만 7$정도 비용적힌 청구서를 받아보니까 정신이 확든다



이러한 노출위험에 경각심을 갖게되고, 앞으로 이런일을 절대 발생시키지 않을거다 생각하면

만원도 안되는 돈으로 경험해본게 차라리 다행이다 싶다.



만약 나중에 취직하고 이런일 터졌다고 생각하면, 만원은 무슨... 

이정도면 싸게 맞았지ㅎㅎ..



현재 AWS Support Center랑 보안설정 확인해야할 부분과 비용면제에 대해서 논의중인데 마무리되면 주말쯤? 전체과정을 한번 정리해놔야겠다.



**현직자 Talking Day**





**주요 키워드**



### 오늘의 할일

- [ ] 220330 TIL 작성
- [ ] 교재 진도부분 읽기 (Cpt4.)
- [x] AWS 계정 새로 파서 셋팅하기(MFA등록,유저생성 및 권한부여, 인스턴스생성및AMI저장 등)
- [ ] 파이썬 필사할 Material 찾아보기


### 추가로 정리해야할 부분



### 수업 정리

가용영역은 가능한 a,c가 좋다

---

**네트워크**

- Net+Work = 연결되어 있는 일
- 서로 정보를 주고 받아 새로운 가치를 생산
- 네트워크를 구성하기 위한 규칙 : 프로토콜

**VPN**

- Virtual Private Network
- 규모가 큰 조직의 네트워크가 분산되어 있을 경우, 각 네트워크를 가상으로 통합-연결
- 암호화 기술을 적용하여 보안 강화
- 클라우드와 온프레미스의 연결을 통해 보안을 강화한 하이브리드 클라우드 구축

#### VPC

- Virtual Private Cloud
- 직접 정의 가능한 가상 네트워크에서 AWS 리소스를 구동할 수 있는 논리적/격리된 N/W
- 주요설정
    - IP 주소 범위
    - 서브넷
    - 라우팅 테이블
    - 네트워크 게이트웨이
    - IPv4 및 IPv6

#### NAT Gateway

    - Network Address Translation Gateway
    - 외부에 공개되지 않은 내부 IP주소를 외부 IP 주소로 변환해주는 서비스
    - 프라이빗 서브넷 내에 있는 인스턴스를 인터넷이나 다른 AWS 서비스에 연결하기 위한 용도
    - DB등과 같이 외부로 연결되면 안되지만, 패치,보안결함,소프트웨어 업데이트등 인터넷 연결이 필요할 경우

**사용 조건**

- 퍼블릭 서브넷 지정
- Elastic IP 주소 생성
- NAT 게이트웨이 생성
- NAT G/W와 연결되도록 프라이빗 서브넷과 연결된 라우팅 테이블 수정 

    - NAT 인스턴스로 대체 가능
        - 퍼블릭 서브넷에서 직접 관리하는 인스턴스

#### VPC

    - Virtual Private Cloud
    - 가상네트워크 상에서 AWS리소스를 구동할 수 있게 해주는 논리적 격리된 네트워크

**주요 설정**

    - IP 주소대역
    - 서브넷
    - 라우팅 테이블
    - 네트워크 G/W
    - IPv4 및 IPv6

**특징**

    - AWS에 사설 네트워크 구축
    - 기존 네트워크환경과 VPN을 연결
    - 모든 리전 지원 가능
    - VPC자체로는 비용발생 X / 네트워크 송수신비용발생

#### 실습


**PRISUB 접속방법**

1. 퍼블릭 IP 주소가 있는 인스턴스로 접속

2. 해당 인스턴스에서 프라이빗 서브넷에 있는 인스턴스로 접속
    - 이유: Prisub에 있는 ins는 같은 vpc에 있는 pubsub ins만이 접속 가능하기 때문에


**VPC 삭제 시 순서**

1. 인스턴스 종료

2. NAT G/W 삭제: 시간좀 걸림. deleted 상태가 되어야 3,4 진행가능

3. 탄력적 IP 릴리즈: NAT G/W가 삭제되어야 릴리즈가능

4. I G/W 삭제: auto igw- vpc에서 분리

5. VPC 삭제

**수동으로 VPC 생성 순서 (Pub,Pri 동시에)**

1. VPC 생성

2. 서브넷 생성

3. 인터넷 게이트웨이 생성

4. Elastic IP 생성

5. NAT G/W 생성 

6. 라우팅 테이블 연결 0.0.0.0/0 (Pub-IGW / Pri-NAT)

7. RTB > 명시적인 서브넷 Pubsub 추가


